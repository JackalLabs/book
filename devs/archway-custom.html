<!DOCTYPE html>
<html id="docs-root" lang="en"><head><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/><meta name="description" content="
If you want to use a custom contract (ie."/><title>Embedding Archway Contracts - Jackal Docs</title><link rel="icon" type="image/png" href="/icon.png"/><link rel="stylesheet" href="/default.min.css"/><script src="/highlight.min.js"></script><script src="/go.min.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" defer="" rel="stylesheet"/><base href="/"/><style>/*! modern-normalize v2.0.0 | MIT License | https://github.com/sindresorhus/modern-normalize */progress,sub,sup{vertical-align:baseline}*,::after,::before{box-sizing:border-box}html{font-family:system-ui,'Segoe UI',Roboto,Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji';line-height:1.15;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4}body{margin:0}hr{height:0;color:inherit}abbr[title]{text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}::-moz-focus-inner{border-style:none;padding:0}:-moz-focusring{outline:ButtonText dotted 1px}:-moz-ui-invalid{box-shadow:none}legend{padding:0}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}</style><style>:root {
	--primary: #E9F451;
	--text: #1B1C16;
	--background: #DDDCCE;
	--secondary: #C6C5AD;
	--title: #1B1C16;
}</style><style>@font-face {
    font-family: "teka";
    src: url("teka-reg.woff") format('woff');
}

@font-face {
    font-family: "teka";
    src: url("teka-bold.woff") format('woff');
    font-weight: bold;
}

html, body {
    color: var(--text);
    background-color: var(--background);
    font-family: teka;
}

button {
    cursor: pointer;
}

#header {
    background-color: var(--title);
    color: var(--background);

    display: flex;
    justify-content: space-between;
    align-items: flex-end;

    padding-left: calc(24px + 1rem);
    padding-right: 100px;

    z-index: 10;
}

#header > * {
    margin: 0px;
}

p > a {
    font-weight: bold;
    text-decoration: underline;
}

p > img {
    max-width: 800px;
    width: 100%;
    display: block;
    margin-right: auto;
    margin-left: auto;
}

#logo {
    height: 48px;
    padding-bottom: 6px;
}

#main {
    display: flex;
    height: 100dvh;
    width: 100vw;
}

#navbar {
    padding: 1rem 20px 80px;

    max-height: 100%;
    overflow-y: scroll;

    font-size: 0.875rem;
    line-height: 1.25rem;

    background-color: var(--secondary);
    z-index: 5;
}

#navbar > h1:first-child {
    display: none;
}

table {
    background-color: var(--secondary);
}

td, th {
    padding: 3px 2px;
    border: 1px solid var(--text);
    min-width: 100px;
}

thead {
    font-size: 1rem;
}

#navbar > * {
    margin: 0px;
}

#navbar > ul > li {
    /*padding: 0rem 0rem 0rem 0.875rem;*/
    margin: 0px;
}


#navbar > ul {
    padding: 0rem 0.375rem 0rem 1.4rem;
    margin: 0px;
}

#navbar > h2 {
    padding: 1.5rem 0.375rem 0.375rem 1.25rem;
    text-transform: uppercase;
    font-size: 1.1rem;
    line-height: 1rem;
}

#page {
    padding-left: 20px;
    padding-right: 80px;
    overflow-y: scroll;
    padding-bottom: 64px;
}

#page > h2 {
    margin-top: 36px;
}

#navbar > li, #navbar > ul {
    user-select: none;
}


li {
    margin-top: 6px;
}

#nv {
    overflow: scroll;
}

ul {
    list-style: none;
    font-style: normal;
}

#page > ul {
    list-style: disc;
}

a.active {
    font-weight: bold;
    /*color: var(--primary);*/
    background-color: var(--primary);
}

a {
    cursor: pointer;
    text-decoration: none;
    color: var(--text);
}

.dropdown {
    cursor: pointer;
}

li.dropdown > ul {
    display: none;
}

li.dropdown.open > ul {
    display: block;
}

.dropdown.open {
    font-style: italic;
}

#navbar > ul > li > a:hover,
#navbar > ul > li > ul > li > a:hover {
    background-color: var(--background);
    transition: background-color 0.3s ease-in-out;
}

code {
    font-weight: bold;
    background-color: var(--secondary);
}

pre {
    position: relative;
}

pre > button {
    position: absolute;
    top: 12px;
    right: 12px;
}

.copy-button {
    background-color: rgba(0, 0, 0, 0);
    border: none;
    padding: 4px 4px 2px;
}

.copy-button:hover {
    background-color: var(--primary);
}


.copy-button::before {
    content: url("data:image/svg+xml,%3Csvg width='18' height='18' viewBox='0 0 256 256' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20.2109 80.4211L20.2109 227.789L188.632 227.789L188.632 206.737L41.2636 206.737L41.2636 80.4211L20.2109 80.4211ZM62.3162 27.7895L62.3162 185.684L251.79 185.684L251.79 27.7895L62.3162 27.7895ZM230.737 48.8421L230.737 164.632L83.3688 164.632L83.3688 48.8421L230.737 48.8421Z' fill='%231B1C16'/%3E%3C/svg%3E%0A");
    stroke: #3388aa;
}

pre > code {
    font-weight: normal;
}

#navbar > ul > li > a,
#navbar > ul > li > ul > li > a {
    width: 100%;
    display: inline-block;

    padding: 0.375rem 0.375rem 0.375rem 0.375rem;
    margin: 0px;
}


.hljs {
    background-color: var(--secondary) !important;
}

.hint {
    background-color: var(--primary);
    padding: 1rem;
    text-align: center;

    margin: 2rem auto;
    max-width: 80%;
}


/* SNACKBAR */
/* The snackbar - position it at the bottom and in the middle of the screen */
#snackbar {
    visibility: hidden; /* Hidden by default. Visible on click */
    min-width: 250px; /* Set a default minimum width */
    margin-left: -125px; /* Divide value of min-width by 2 */
    background-color: var(--text); /* Black background color */
    color: var(--background); /* White text color */
    text-align: center; /* Centered text */
    border-radius: 2px; /* Rounded borders */
    padding: 16px; /* Padding */
    position: fixed; /* Sit on top of the screen */
    z-index: 1; /* Add a z-index if needed */
    left: 50%; /* Center the snackbar */
    top: 90px; /* 30px from the bottom */
}

/* Show the snackbar when clicking on a button (class added with JavaScript) */
#snackbar.show {
    visibility: visible; /* Show the snackbar */
    /* Add animation: Take 0.5 seconds to fade in and out the snackbar.
    However, delay the fade out process for 2.5 seconds */
    -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;
    animation: fadein 0.5s, fadeout 0.5s 2.5s;
}

/* Animations to fade the snackbar in and out */
@-webkit-keyframes fadein {
    from {
        top: 60px;
        opacity: 0;
    }
    to {
        top: 90px;
        opacity: 1;
    }
}

@keyframes fadein {
    from {
        top: 60px;
        opacity: 0;
    }
    to {
        top: 90px;
        opacity: 1;
    }
}

@-webkit-keyframes fadeout {
    from {
        top: 90px;
        opacity: 1;
    }
    to {
        top: 60px;
        opacity: 0;
    }
}

@keyframes fadeout {
    from {
        top: 90px;
        opacity: 1;
    }
    to {
        top: 60px;
        opacity: 0;
    }
}</style><style>
#menu {
    display: none;
    position: absolute;
    right: 16px;
    top: 1rem;

    background-color: #00000000;
    border: none;
    padding-top: 4px;
    padding-bottom: 4px;
    font-size: 24px;
    color: var(--background);
    width: min-content;
}


@media only screen and (max-width: 600px) {


    #menu {
        display: block;


    }

    #main {
        display: block;
        /*grid-template-columns: 1fr 3fr;*/
        /*grid-template-rows: 80px 1fr ;*/
        /*grid-template-areas:*/
        /*    "header header"*/
        /*    "page page ";*/

        overflow-y: scroll;
        max-height: 100dvh;
    }

    #navbar {
        box-sizing: border-box;
        position: absolute;
        top: 3.95rem;
        left: 0;
        width: 100vw;
        height: 0vh;
        grid-area: nav;
        transition: height 0.4s;
        padding-top: 0px;
        padding-bottom: 0px;

        overflow-y: hidden;

        background-color: var(--text);
        color: var(--background);
    }

    #navbar > ul > li > a {
        color: var(--background);
    }

    #navbar > ul > li > a.active {
        color: var(--text);
    }

    #navbar.open {
        height: calc(100vh - 3.95rem);
        overflow-y: scroll;
    }

    #navbar.open > *:last-child {
        margin-bottom: 160px;
    }

    #navbar.open > ul:nth-child(2) {
        margin-top: 40px;
    }

    #page {

        padding-left: 0px;
        padding-right: 0px;

        padding-top: 68px;

        margin-left: auto;
        margin-right: auto;

        width: calc(100% - (24px + 1rem) * 2);

    }

    #header {
        position: absolute;
        top: 0px;
        left: 0px;
        width: 100vw;
        height: 4rem;
        padding-left: 16px;
    }

}

@media only screen and (min-width: 600px) {

    #main {
        display: grid;
        grid-template-columns: fit-content(33%) 3fr;
        grid-template-rows: 80px 1fr;
        grid-template-areas:
            "header header"
            "nav page ";
    }

    #navbar {
        display: block;
        grid-area: nav;
    }

    #page {
        grid-area: page;
    }

    #header {
        grid-area: header;
    }

}


</style></head><body><div id="main"><div id="header"><img src="logo.png" alt="site logo" id="logo"/><div></div><button id="menu" aria-label="navigation menu button"><i id="bars" class="fa fa-bars"></i></button></div><div id="navbar"><html><head></head><body><h1 id="table-of-contents">Table of contents</h1>

<h2 id="get-started-with-jackal">Get Started with Jackal</h2>

<ul>
<li><a href="README.html">Introduction</a></li>
<li><a href="get-started-with-jackal/learn-about-jackal.html">Learn About Jackal</a></li>
<li><a href="get-started-with-jackal/the-usdjkl-token.html">The $JKL Token</a></li>
</ul>

<h2 id="wallet">Wallet</h2>

<ul>
<li><a href="wallet/keplr.html">Keplr</a></li>
<li><a href="wallet/leap.html">Leap</a></li>
<li><a href="wallet/command-line.html">Command Line</a></li>
</ul>

<h2 id="the-blockchain">The Blockchain</h2>

<ul>
<li><a href="the-blockchain/storage-module.html">Storage Module</a></li>
<li><a href="the-blockchain/file-tree-module.html">File Tree Module</a></li>
<li><a href="the-blockchain/mint-module.html">Mint Module</a></li>
<li><a href="the-blockchain/name-service-module.html">Name Service Module</a></li>
</ul>

<h2 id="nodes">Nodes</h2>

<ul>
<li><a href="nodes/hardware.html">Hardware</a></li>
<li><a href="nodes/installing-full-node.html">Installing Full-Node</a></li>
<li><a href="nodes/joining-a-network.html">Joining a Network</a></li>
<li><a href="nodes/create-a-validator.html">Create a Validator</a></li>
</ul>

<h2 id="providing-storage">Providing Storage</h2>

<ul>
<li><a href="providing-storage/creating-storage-provider.html">Creating Storage Provider</a></li>
<li><a href="providing-storage/sequoia-config.html">Sequoia Config</a></li>
<li><a href="providing-storage/sequoia-api.html">Sequoia API</a></li>
</ul>

<h2 id="developers">Developers</h2>

<ul>
<li><a href="devs/jjs-quickstart.html">Jackal.js Quickstart</a></li>
<li><a href="devs/archway-quickstart.html">Archway Quickstart</a></li>
<li><a href="devs/archway-custom.html" class="active">Embedding Archway Contracts</a></li>
<li><a href="devs/outpost-quickstart.html">EVM Outpost Quickstart</a></li>
<li><a href="https://internalapi.jackalprotocol.com">Jackal API Reference</a></li>
</ul>

<h2 id="apps">Apps</h2>

<ul>
<li><a href="https://pindocs.jackalprotocol.com">Jackal Pin</a></li>
</ul>
</body></html></div><div id="page"><html><head></head><body><h1 id="custom-archway-contracts">Custom Archway Contracts</h1>

<p>If you want to use a custom contract (ie. embedding storage into your own contracts) you will need to follow a contract API that lets Jackal.js call the contracts interchangeably.</p>

<p>Here is a trimmed down version of our <code>outpost factory</code> contract. This contract has two main functions, <code>CreateOutpost</code> will create a new copy of the ICA controller contract.
And querying the state of this contract lets us figure out which controller contract to call to upload files.</p>

<h2 id="example-custom-contract">Example Custom Contract</h2>

<pre><code class="language-rust">#[cfg(not(feature = &#34;library&#34;))]
use cosmwasm_std::entry_point;
use cosmwasm_std::{to_json_binary, Binary, Deps, DepsMut, Env, MessageInfo, Response, StdResult};

use crate::error::ContractError;
use crate::msg::{ExecuteMsg, InstantiateMsg, QueryMsg};
use crate::state::{ContractState, STATE};

#[cfg_attr(not(feature = &#34;library&#34;), entry_point)]
pub fn instantiate(
    deps: DepsMut,
    _env: Env,
    info: MessageInfo,
    msg: InstantiateMsg,
) -&gt; Result&lt;Response, ContractError&gt; {
    STATE.save(
        deps.storage,
        &amp;ContractState::new(msg.storage_outpost_code_id, info.sender.to_string()),
    )?;
    Ok(Response::default())
}

#[cfg_attr(not(feature = &#34;library&#34;), entry_point)]
pub fn execute(
    deps: DepsMut,
    env: Env,
    info: MessageInfo,
    msg: ExecuteMsg,
) -&gt; Result&lt;Response, ContractError&gt; {
    match msg {
        ExecuteMsg::CreateOutpost {
            channel_open_init_options,
        } =&gt; execute::create_outpost(deps, env, info, channel_open_init_options),
        ExecuteMsg::MapUserOutpost { outpost_owner} =&gt; execute::map_user_outpost(deps, env, info, outpost_owner),
    }
}

#[cfg_attr(not(feature = &#34;library&#34;), entry_point)]
pub fn query(deps: Deps, _env: Env, msg: QueryMsg) -&gt; StdResult&lt;Binary&gt; {
    match msg {
        QueryMsg::GetContractState {} =&gt; to_json_binary(&amp;query::state(deps)?),
        QueryMsg::GetUserOutpostAddress { user_address } =&gt; to_json_binary(&amp;query::user_outpost_address(deps, user_address)?),
        QueryMsg::GetAllUserOutpostAddresses {  } =&gt; to_json_binary(&amp;query::get_all_user_outpost_addresses(deps)?),
    }
}

mod execute {
    use cosmwasm_std::{Addr, BankMsg, Coin, CosmosMsg, Uint128, Event, to_json_binary};
    use storage_outpost::outpost_helpers::StorageOutpostContract;
    use storage_outpost::types::msg::ExecuteMsg as IcaControllerExecuteMsg;
    use storage_outpost::types::state::{CallbackCounter, ChannelState};
    use storage_outpost::{
        outpost_helpers::StorageOutpostCode,
        types::msg::options::ChannelOpenInitOptions,
    };
    use storage_outpost::types::callback::Callback;
    use serde_json_wasm::from_str;

    use crate::state::{self, USER_ADDR_TO_OUTPOST_ADDR, LOCK};

    use super::*;
    pub fn create_outpost(
        deps: DepsMut,
        env: Env,
        info: MessageInfo,
        channel_open_init_options: ChannelOpenInitOptions,
    ) -&gt; Result&lt;Response, ContractError&gt; {
        let state = STATE.load(deps.storage)?;

        let storage_outpost_code_id = StorageOutpostCode::new(state.storage_outpost_code_id);

        if let Some(value) = USER_ADDR_TO_OUTPOST_ADDR.may_load(deps.storage, &amp;info.sender.to_string())? {
            return Err(ContractError::AlreadyCreated(value))
        }

        let _lock = LOCK.save(deps.storage, &amp;info.sender.to_string(), &amp;true);

        let callback = Callback {
            contract: env.contract.address.to_string(),
            msg: None,
            outpost_owner: info.sender.to_string(),
        };

        let instantiate_msg = storage_outpost::types::msg::InstantiateMsg {
            owner: Some(info.sender.to_string()),
            admin: Some(env.contract.address.to_string()),
            channel_open_init_options: Some(channel_open_init_options),
            callback: Some(callback),
        };

        let label
            = format!(&#34;storage_outpost-owned by: {}&#34;, &amp;info.sender.to_string());

        let cosmos_msg = storage_outpost_code_id.instantiate(
            instantiate_msg,
            label,
            Some(env.contract.address.to_string()),
        )?;

        let mut event = Event::new(&#34;FACTORY: create_ica_contract&#34;);
        event = event.add_attribute(&#34;info.sender&#34;, &amp;info.sender.to_string());

        Ok(Response::new().add_message(cosmos_msg).add_event(event))
    }

    pub fn map_user_outpost(
        deps: DepsMut,
        env: Env,
        info: MessageInfo,
        outpost_owner: String,
    ) -&gt; Result&lt;Response, ContractError&gt; {
        let lock = LOCK.may_load(deps.storage, &amp;outpost_owner)?;

        if let Some(true) = lock {
            LOCK.save(deps.storage, &amp;outpost_owner, &amp;false)?;
        } else {
            return Err(ContractError::MissingLock {})
        }

        USER_ADDR_TO_OUTPOST_ADDR.save(deps.storage, &amp;outpost_owner, &amp;info.sender.to_string())?;

        let mut event = Event::new(&#34;FACTORY:map_user_outpost&#34;);
        event = event.add_attribute(&#34;info.sender&#34;, &amp;info.sender.to_string());

        Ok(Response::new().add_event(event))
    }

    mod query {
        use crate::state::{USER_ADDR_TO_OUTPOST_ADDR};

        use super::*;

        pub fn state(deps: Deps) -&gt; StdResult&lt;ContractState&gt; {
            STATE.load(deps.storage)
        }

        pub fn user_outpost_address(deps: Deps, user_address: String) -&gt; StdResult&lt;String&gt; {
            USER_ADDR_TO_OUTPOST_ADDR.load(deps.storage, &amp;user_address)
        }

        pub fn get_all_user_outpost_addresses(deps: Deps) -&gt; StdResult&lt;Vec&lt;(String, String)&gt;&gt; {
            let mut all_entries = Vec::new();

            let pairs = USER_ADDR_TO_OUTPOST_ADDR
                .range(deps.storage, None, None, cosmwasm_std::Order::Ascending);

            for pair in pairs {
                let (key, value) = pair?;
                all_entries.push((key.to_string(), value));
            }

            Ok(all_entries)
        }
    }
}
</code></pre>

<p>Please refer to this GitHub repo for more information: <a href="https://github.com/JackalLabs/storage-outpost/blob/master/cross-contract/contracts/outpost-factory/src/contract.rs">https://github.com/JackalLabs/storage-outpost/blob/master/cross-contract/contracts/outpost-factory/src/contract.rs</a></p>

<h2 id="integrating-with-jackal-js">Integrating with Jackal.js</h2>

<p>When using a custom contract, you can make Jackal.js use it instead of the default Outpost Factory. It is as easy as adding a <code>contract</code> field to the <code>createWasmStorageHandler</code> function call.</p>

<pre><code class="language-typescript">myStorageHandler.createWasmStorageHandler({contract: &#39;YOUR_CONTRACT_ADDRESS_HERE&#39;})
</code></pre>
</body></html></div><div id="snackbar"></div></div><script>window.addEventListener("load", start)


function start() {
    console.log("hello world!")

    const menuButton = document.getElementById("menu")
    const nav = document.getElementById("navbar")
    menuButton.addEventListener("click", () => {
        if (nav.classList.contains("open")) {
            nav.classList.remove("open")
        } else {
            nav.classList.add("open")
        }

    })

    const codeBlocks = []

    const allPres = document.getElementsByTagName("pre")

    for (const allPre of allPres) {
        const innerCodeBlocks = allPre.getElementsByTagName("code")

        const code = innerCodeBlocks[0].innerText


        const button = document.createElement("button")
        button.classList.add("copy-button")
        button.ariaLabel = "Copy Code Button"

        button.addEventListener("click", () => {
            console.log("yo!")

            navigator.clipboard.writeText(code).then(() => {
                let x = document.getElementById("snackbar");

                // Add the "show" class to DIV
                x.innerText = "Code copied to clipboard."
                x.className = "show";

                // After 3 seconds, remove the show class from DIV
                setTimeout(function () {
                    x.className = x.className.replace("show", "");
                }, 3000);

            })

        }, false)

        allPre.appendChild(button)

    }

    console.log("highlighting...")
    hljs.highlightAll();




}</script></body></html>